{% extends 'base.html' %}
{% load staticfiles %}
{% load range_filter %}
{% block title %}new requests{% endblock title %}
{% block content %}
    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-10 h4">
            <h3><b>Last requests:</b></h3>
            <form id="edit_req_prior_form" action="" method="post">
            {% csrf_token %}
            <table id="requests_table" class="table table-hover">
                <thead>
                    <tr>
                        <th>â„–</th>
                        <th>Request Time</th>
                        <th>Path</th>
                        <th>Status Code</th>
                        <th>Method</th>
                        <th>Status</th>
                        <th>Priority</th>
                    </tr>
                </thead>
                {% if requests %}
                    <div id="last_edit_time" style="display:none;">{{ last_edit_req.edit_time|date:'c' }}</div>
                    <tbody id="requests_table_content">
                        {% for req in requests %}
                            <tr>
                                <td>{{forloop.counter}}</td>
                                <td>{{ req.request_time|date:'c' }}</td>
                                <td>{{ req.path }}</td>
                                <td>{{ req.status_code }}</td>
                                <td>{{ req.method }}</td>
                                <td>NEW</td>
                                <td>
                                    <select name="{{ req.id }}">
                                        {% for i in 6|create_range %}
                                            {% if i == req.priority %}
                                                <option value={{ i }} selected>{{ i }}</option>
                                            {% else %}
                                                <option value={{ i }}>{{ i }}</option>
                                            {% endif %}
                                        {% endfor %}
                                    </select>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                {% else %}
                    <tbody id="no_requests_table">
                        <tr>
                            <td colspan="5" align="center"><h3>No requests was found</h3></td>
                        </tr>
                    </tbody>
                {% endif %}
            </table>
                <button id="update_btn" type="submit" class="btn btn-primary">Update requests</button>
            </form>
        </div>
    </div>
{% endblock %}
{% block scripts %}
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src='{% static "js/requests_mod.js" %}'></script>
{% endblock scripts %}
